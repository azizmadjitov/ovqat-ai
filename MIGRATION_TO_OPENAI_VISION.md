# –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ OpenAI Vision API

## üìã –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **Ovqat AI** —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **OpenAI Vision API (GPT-4o)** –≤–º–µ—Å—Ç–æ Google Cloud Vision API –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –µ–¥—ã –∏ –∞–Ω–∞–ª–∏–∑–∞ –ø–∏—Ç–∞–Ω–∏—è.

## üéØ –ü—Ä–∏—á–∏–Ω—ã –º–∏–≥—Ä–∞—Ü–∏–∏

1. **–õ—É—á—à–µ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –µ–¥—ã** - GPT-4o Vision –Ω–∞–ø—Ä—è–º—É—é –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –ª—É—á—à–µ –ø–æ–Ω–∏–º–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –±–ª—é–¥
2. **–ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∫—É—Ö–æ–Ω—å** - –±–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –±–ª—é–¥ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞–Ω –º–∏—Ä–∞
3. **–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –æ–¥–∏–Ω API –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö (Google Vision + OpenAI)
4. **–ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** - –ø—Ä—è–º–æ–π –∞–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –º–µ—Ç–æ–∫

## üîÑ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –£–¥–∞–ª–µ–Ω–æ
- ‚ùå Google Cloud Vision API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚ùå –§—É–Ω–∫—Ü–∏—è `callVisionAPI()`
- ‚ùå –§—É–Ω–∫—Ü–∏—è `extractFoodInfo()`
- ‚ùå –î–≤—É—Ö—ç—Ç–∞–ø–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å (–º–µ—Ç–∫–∏ ‚Üí –∞–Ω–∞–ª–∏–∑)

### –î–æ–±–∞–≤–ª–µ–Ω–æ
- ‚úÖ OpenAI Vision API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `callOpenAIVisionAPI()`
- ‚úÖ –ü—Ä—è–º–æ–π –∞–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–¥–Ω–∏–º –≤—ã–∑–æ–≤–æ–º API
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è GPT-4o Vision

### –§–∞–π–ª—ã
- **–ò–∑–º–µ–Ω–µ–Ω–æ**: `src/services/nutrition.ts` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∞–Ω–∞–ª–∏–∑–∞
- **–û–±–Ω–æ–≤–ª–µ–Ω–æ**: `README.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- **–û–±–Ω–æ–≤–ª–µ–Ω–æ**: `prompts/prompt.nutrition-expert.md` - –ø—Ä–æ–º–ø—Ç –¥–ª—è AI

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–¢–µ–ø–µ—Ä—å –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ **–æ–¥–∏–Ω API –∫–ª—é—á**:

```bash
# .env.local –∏–ª–∏ .env
VITE_OPENAI_API_KEY=sk-...        # –í–∞—à OpenAI API –∫–ª—é—á
VITE_USE_MOCK=0                    # 0 = —Ä–µ–∞–ª—å–Ω—ã–π API, 1 = –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
```

**–ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å** (–±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è):
```bash
VITE_GOOGLE_VISION_API_KEY=...    # ‚ùå –ù–µ –Ω—É–∂–µ–Ω
VITE_GOOGLE_CLOUD_API_KEY=...     # ‚ùå –ù–µ –Ω—É–∂–µ–Ω
```

### 2. –ú–æ–¥–µ–ª—å

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å **GPT-4o** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π vision:

```typescript
model: 'gpt-4o'  // GPT-4o —Å vision capabilities
```

### 3. –°—Ç–æ–∏–º–æ—Å—Ç—å

- **Google Vision**: ~$1.50 –∑–∞ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ (Label Detection) + OpenAI API
- **OpenAI Vision (GPT-4o)**: ~$0.01 –∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞)

## üìä –£–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞

### –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ
- ‚úÖ –õ—É—á—à–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ª–æ–∂–Ω—ã–µ –±–ª—é–¥–∞
- ‚úÖ –ü–æ–Ω–∏–º–∞–µ—Ç –∫—É–ª—å—Ç—É—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- ‚úÖ –†–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞—Ü–∏–∏
- ‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–ø–æ—Å–æ–± –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è

### –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ—Å–≤–µ–¥–æ–º–ª–µ–Ω–Ω–æ—Å—Ç—å
- üåè –ê–∑–∏–∞—Ç—Å–∫–∞—è –∫—É—Ö–Ω—è (—è–ø–æ–Ω—Å–∫–∞—è, –∫–∏—Ç–∞–π—Å–∫–∞—è, –∫–æ—Ä–µ–π—Å–∫–∞—è, —Ç–∞–π—Å–∫–∞—è, –∏–Ω–¥–∏–π—Å–∫–∞—è)
- üåç –ï–≤—Ä–æ–ø–µ–π—Å–∫–∞—è –∫—É—Ö–Ω—è (–∏—Ç–∞–ª—å—è–Ω—Å–∫–∞—è, —Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∞—è, –∏—Å–ø–∞–Ω—Å–∫–∞—è, –≥—Ä–µ—á–µ—Å–∫–∞—è)
- üåé –ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∞—è –∫—É—Ö–Ω—è (–°–®–ê, –º–µ–∫—Å–∏–∫–∞–Ω—Å–∫–∞—è, –±—Ä–∞–∑–∏–ª—å—Å–∫–∞—è, –∞—Ä–≥–µ–Ω—Ç–∏–Ω—Å–∫–∞—è)
- üåç –ê—Ñ—Ä–∏–∫–∞–Ω—Å–∫–∞—è –∫—É—Ö–Ω—è (—ç—Ñ–∏–æ–ø—Å–∫–∞—è, –º–∞—Ä–æ–∫–∫–∞–Ω—Å–∫–∞—è)
- üåè –ë–ª–∏–∂–Ω–µ–≤–æ—Å—Ç–æ—á–Ω–∞—è –∫—É—Ö–Ω—è (–ª–∏–≤–∞–Ω—Å–∫–∞—è, –ø–µ—Ä—Å–∏–¥—Å–∫–∞—è, –∏–∑—Ä–∞–∏–ª—å—Å–∫–∞—è)
- üåè –û–∫–µ–∞–Ω—Å–∫–∞—è –∫—É—Ö–Ω—è (–∞–≤—Å—Ç—Ä–∞–ª–∏–π—Å–∫–∞—è, –ø–æ–ª–∏–Ω–µ–∑–∏–π—Å–∫–∞—è)

### –¢–æ—á–Ω–æ—Å—Ç—å
- **Confidence-based naming**: 
  - Confidence ‚â• 0.7 ‚Üí –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞
  - Confidence < 0.7 ‚Üí –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ

## üîç –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥ (Google Vision + OpenAI)
```
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üí Google Vision ‚Üí –ú–µ—Ç–∫–∏ ‚Üí OpenAI ‚Üí –ê–Ω–∞–ª–∏–∑ –ø–∏—Ç–∞–Ω–∏—è
```

### –ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ (OpenAI Vision)
```
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üí GPT-4o Vision ‚Üí –ê–Ω–∞–ª–∏–∑ –ø–∏—Ç–∞–Ω–∏—è
```

## üìù –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –í src/services/nutrition.ts
export async function analyzeMeal(file: File): Promise<NutritionResult> {
  const compressedFile = await compressImage(file);
  const nutritionData = await callOpenAIVisionAPI(compressedFile);
  return nutritionData;
}
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

–ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:

```
üñºÔ∏è Calling OpenAI Vision API for food analysis...
‚úÖ OpenAI Vision API response status: 200
ü§ñ OpenAI Vision Raw Response: {...}
üìÑ OpenAI Vision JSON Content: {...}
‚úÖ Parsed AI Result: { title, confidence, calories, ... }
üéØ Full Parsed JSON: {...}
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

1. **API –∫–ª—é—á**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ GPT-4o –º–æ–¥–µ–ª–∏
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `VITE_USE_MOCK=1` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ API
3. **–†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∂–∏–º–∞–µ—Ç—Å—è –¥–æ ‚â§1024px
4. **–§–æ—Ä–º–∞—Ç**: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è JPEG, PNG
5. **Temperature**: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ 0.0 –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [OpenAI Vision API Documentation](https://platform.openai.com/docs/guides/vision)
- [GPT-4o Model Card](https://openai.com/index/hello-gpt-4o/)

---

**–î–∞—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏–∏**: 2025-10-12  
**–í–µ—Ä—Å–∏—è**: 1.0.0 ‚Üí 2.0.0 (OpenAI Vision)
